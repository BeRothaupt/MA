% !TeX root = ../../../Main.tex
\chapter{Results}
\label{chapter6}

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/opti500m-coarse.dat}}\dataOPTIfiveH

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/opti1000m-coarse.dat}}\dataOPTIoneK

%\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/opti2000m-coarse.dat}}\dataOPTItwoK

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/dat-no118-i3-500m-dt250ms_linear_table.dat}}\dataVIfiveHcoarse

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/dat-no115-i17-500m-dt250ms_linear_table.dat}}\dataOPIfiveHcoarse

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/dat-no119-i14-500m-dt250ms_linear_table.dat}}\dataGPIfiveHcoarse


\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/dat-no108-i7-500m-dt250ms.dat}}\dataVIfiveHfine

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/dat-no120-i0-1000m-dt250ms.dat}}\dataVIoneK

%\pgfplotstableread[col sep=comma] {\detokenize{}}\dataVItwoK

\pgfplotstableread[col sep=comma]
{\detokenize{./src/pics/tikz/trpo-glorot-vi-1km-AvgRet.dat}}\trpoGlorotVsVIoneKAvgReturn

\pgfplotstableread[col sep=comma]
{\detokenize{./src/pics/tikz/trpo-glorot-vi-1km-MaxRet.dat}}\trpoGlorotVsVIoneKMaxReturn

\section{2D Dynamic Programming}

\subsection{Optimal Control Benchmark}
\label{sec:results_dp}
In the 2D scenario, three Dynamic Programming algorithms are compared:

\begin{itemize}
	\item Generalized policy iteration (cf. section \ref{sec:PI})
	\item Optimistic policy iteration (cf. section \ref{sec:PI})
	\item Value iteration (cf. section \ref{subsection:VI})
\end{itemize}

The agent faces three different scenarios, each with calm air. Table \ref{tab:scenario_data} shows the distance to cover, start state, and the mean and standard deviation for state normalization (cf. section~\ref{sec:input_standardization}) for each scenario. The agent starts at a height of 100m and with zero velocity in all scenarios. For each scenario, there is a separate mean $\mu$ and standard deviation $\sigma$ for each coordinate. Therefore, each column contains a vector of means and standard deviations.

\begin{table}[h]
	\begin{center}
		\begin{tabular}{r|c c}
			scenario & 1 & 2 \\ \hline
			distance $d_T$ & 500m & 1000m \\
			start state $s_0$ & $s_0 = [0, 100, 0, 0]^\top$ &  $s_0 = [0, 100, 0, 0]^\top$ \\
			normalization $\mu$ & $[250, 50, 10, 5]$  &$[500, 50, 10, 5]$ \\
			normalization $\sigma$ & $[150, 30, 5, 2]$ & $[300, 30, 5, 2]$
		\end{tabular}
		\caption{Some information about the investigated scenarios}
		\label{tab:scenario_data}
	\end{center}
\end{table}
%
%\begin{table}[h]
%	\begin{center}
%		\begin{tabular}{r|c c c}
%			scenario & 1 & 2 & 3 \\ \hline
%			distance $d_T$ & 500m & 1000m & 2000m\\
%			start state $s_0$ & $s_0 = [0, 100, 0, 0]^\top$ &  $s_0 = [0, 100, 0, 0]^\top$  &  $s_0 = [0, 100, 0, 0]^\top$  \\
%			normalization $\mu$ & $[250, 50, 10, 5]$  &$[500, 50, 10, 5]$ & $[1000, 50, 15, 1]$ \\
%			normalization $\sigma$ & $[150, 30, 5, 2]$ & $[300, 30, 5, 2]$ & $[600, 30, 6, 3]$
%		\end{tabular}
%		\caption{Some information about the investigated scenarios}
%		\label{tab:scenario_data}
%	\end{center}
%\end{table}

Recall that policy iteration algorithms produce a sequence of value-functions and policies that approximate $V_*$ and $\pi_*$. Each iterate $V_{k+1}$ and $\pi_{k+1}$ is closer to $V_*$ and $\pi_*$ than its predecessor $V_k$ and $\pi_k$.
In the GPI algorithm, the iterative evaluation stops, if the values of all states change by less than the reward for one time step $\Delta t$ within one evaluation step. When this point is reached, only the time penalty propagates through the network. At states $s_t$, where the agent only moves slowly, chances are that the successor state $s_{t+1}$ is (roughly) equal to $s_t$ (and therefore $V(s_t)=V(s_{t+1})$). In such cases, the state value $V(s_t)$ is overwritten with $r_t + V(s_t)$ at each iteration. This goes on indefinitely if PE is not stopped manually. Every policy iteration where the evaluation step is repeated multiple times obviously takes longer than an optimistic policy iteration. The whole policy iteration algorithm has converged if - at the last policy improvement step - none of the actions have changed. This means that all actions were already optimal with respect to the current value function as well as the previous one. \smallbreak

Value iteration only iterates state value functions. It combines one step of policy evaluation and policy improvement in every iteration. One value iteration therefore usually takes less time than one step of policy iteration. If a close approximation of $V_*$ is found, a policy can be derived by acting greedily with respect to the last value function iterate.

\subsubsection{Scenario 1 - Coarse Discretization}

In scenario 1, the agent has to cover $500~\text{m}$ while flying through calm air. Table \ref{tab:2d_flight_data_500m} shows the flight times from the start-state to the goal after policy optimization with synchronous\footnote{Recall from chapter \ref{chapter2}, that synchronous algorithms update all state values simultaneously after a sweep over the complete state space. They usually are easier to implement and do not exploit the problem structure, but take longer to converge.} GPI, OPI and VI on a coarse grid (cf. Tab.~\ref{tab:grids}, column 1 (left)). This comparison has two goals: Investigating how the algorithms deal with a coarse grid and comparing calculation times. As a benchmark, the optimal control \nomenclature[A]{OC}{optimal control} is shown in the first column. Calculation time is the time it took to obtain the given trajectories and control sequences. Note that lower calculation and flight times are better.

Although all three DP algorithms theoretically take up to $|\mathcal{A}|^{|\mathcal{S}|}$ iterations to converge (c.f. section \ref{sec:PI}), they are known to typically converge after only few iterations. This is also the case in this scenario. All algorithms yield similar flight times that are significantly higher than the OC result. The main reason for this is the coarse state grid, i.e. poor approximation of the true (optimal) value function. As can be seen in table \ref{tab:2d_flight_data_500m}, VI takes the least calculation time. As all DP algorithms converge to a reasonable solution, only optimistic policy iteration and value iteration are considered for further investigation. Calculation time gets more critical at higher distances, i.e. more grid points (cf. section~\ref{sec:curses}). Fig. \ref{tikz:vi500mcoarse} shows the trajectory obtained by synchronous VI in scenario 1. The thick line is the glider trajectory $[x(t),z(t)]^T$, the thin line is the control sequence $[x(t),\alpha(t)]^T$. Figures~\ref{tikz:vi500mcoarse},~\ref{tikz:vi500m} and~\ref{tikz:vi1000m} contain a few of the grid cells in the lower left corner to illustrate the respective discretization method. The other algorithms yield similar trajectories, which can be found in appendix \ref{appendixE}.

\begin{table}[htb]
	\begin{center}
		\begin{tabular}{l|c c c c}
			 & OC & GPI & OPI & VI \\ \hline
			iterations (-) & - & 15 & 18 & 17 \\
			calculation time (h:min) & 0:15 & 3:15 & 1:54 & 1:42 \\
			flight time (s) & 19.7 & 21.2 & 21.2 & 21.2
		\end{tabular}
		\caption{Scenario 1, comparison of synchronous algorithms on a coarse grid}
		\label{tab:2d_flight_data_500m}
	\end{center}
\end{table}

To reduce computing time, OPI and VI have also been implemented as asynchronous algorithms (cf. section \ref{sec:prob_structure}). As can be seen in table~\ref{tab:2d_flight_data_500m_async}, the number of required iterations is significantly lower than in the synchronous case. Each iteration takes longer than in synchronous PI and VI, because splitting the state-set into layers and distributing the data to the CPU cores requires more effort here than in the synchronous case. The trajectories obtained by the asynchronous implementations are identical to their synchronous counterparts (cf. Fig.~\ref{tikz:vi500mcoarse},~\ref{tikz:gpi500mcoarse} and~\ref{tikz:opi500mcoarse}). They are therefore not presented here.

\begin{table}[htb]
	\begin{center}
		\begin{tabular}{l|c c c}
			& OC & OPI & VI \\ \hline
			iterations (-) & - & 6 & 4 \\
			calculation time (h:min) & 0:15 & 0:37 & 0:29  \\
			flight time (s) & 19.7 & 21.2 & 21.2
		\end{tabular}
		\caption{Scenario 1, comparison of asynchronous algorithms on a coarse grid}
		\label{tab:2d_flight_data_500m_async}
	\end{center}
\end{table}
\begin{table}[htb]
	\begin{center}
		\begin{tabular}{l|c c}
			& OC & VI \\ \hline
			iterations (-) & - & 7 \\
			calculation time (h:min) & 0:15 & 2:04 \\
			flight time (s) & 19.7 & 20.0
		\end{tabular}
		\caption{Scenario 2, performance of asynchronous VI on a fine grid}
		\label{tab:2d_flight_data_500m_async_fine_grid}
	\end{center}
\end{table}
\tikzsetnextfilename{optiandvi500mcoarse}
\begin{figure}[hbt]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.85\textwidth,
		height=0.65\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=500,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	

	\draw[color=gray,thin] (0,4) -- +(75,0);

	\draw[color=gray,thin] (0,8) -- +(65,0);

	\draw[color=gray,thin] (0,12) -- +(45,0);

	\draw[color=gray,thin] (0,16) -- +(25,0);
	

	\draw[color=gray,thin] (20,0) -- +(0,17);

	\draw[color=gray,thin] (40,0) -- +(0,13.5);

	\draw[color=gray,thin] (60,0) -- +(0,9);

	% aircraft trajectory
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataOPTIfiveH};
	\addplot[blue, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIfiveHcoarse};
	\end{axis}
	
	\begin{axis}[
	clip mode=individual,
	ymin=0, ymax=0.2,
	axis y line*=right,
	xtick=\empty,
	xlabel=\empty,
	%xlabel near ticks,
	ylabel={$\alpha$ (rad)},
	ylabel near ticks,
	]
	% aircraft controls
	\addplot[red, line width=0.5pt, mark=none,forget plot] table[x index=0, y index=2]{\dataOPTIfiveH};
	\addplot[blue, line width=0.5pt, mark=none,forget plot] table[x index=0, y 
	index=4]{\dataVIfiveHcoarse};
	
	\addlegendimage{red,line width=1.2pt, mark=none}\addlegendentry{OC}
	\addlegendimage{red,line width=0.5pt, mark=none}\addlegendentry{OC - control sequence}
	\addlegendimage{blue,line width=1.2pt, mark=none}\addlegendentry{VI}
	\addlegendimage{blue,line width=0.5pt, mark=none}\addlegendentry{VI - control sequence}
	
	\end{axis}
	
	\foreach \gridrow in {}{
		\draw[color=gray] (0,0.409*\textheight - \gridrow*0.02045*\textheight) -- + (0.2*\textwidth-0.03*\textwidth*\gridrow,0);
	}
	\foreach \gridcol in {}{
		\draw[color=gray] (\gridcol*0.03*\textwidth,0.409*\textheight) -- + (0,-0.14*\textheight+0.02*\textheight*\gridcol);
	}
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (0,0.409*\textheight) {\includegraphics[ width=1.5cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\end{tikzpicture}
	\caption{Results of synchronous value iteration and optimal control in scenario 1}
	\label{tikz:vi500mcoarse}
\end{figure}

Figures~\ref{tikz:gpi500mcoarse} and~\ref{tikz:opi500mcoarse} in the appendix show the results of value iteration, generalized policy iteration and optimistic policy iteration, respectively.

\subsubsection{Scenario 1 - Fine Discretization}

In this section, the result of asynchronous value iteration on a fine state grid is shown. The number of points in the x- and z-directions are now 52 instead of 27. The speed vector discretization is like in the previous section.

The asynchronous VI algorithm works itself through the state space backwards, updating the state values close to the target first and moving backwards from there (cf. \ref{sec:prob_structure}). This increases convergence speed significantly. The number of required iterations is also independent of the number of states with this method. This is not the case with synchronous updates (i.e. updating all state values at once after a complete state space sweep). 

\tikzsetnextfilename{optiandvi500m}
\begin{figure}[hbt]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.85\textwidth,
		height=0.65\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=500,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	
	% aircraft trajectory
	
		\draw[color=gray,thin] (0,2) -- +(72,0);
		\draw[color=gray,thin] (0,4) -- +(69,0);
		\draw[color=gray,thin] (0,6) -- +(65,0);
		\draw[color=gray,thin] (0,8) -- +(58,0);
		\draw[color=gray,thin] (0,10) -- +(50,0);
		\draw[color=gray,thin] (0,12) -- +(40,0);
		\draw[color=gray,thin] (0,14) -- +(25,0);
		\draw[color=gray,thin] (0,16) -- +(5,0);
		
		\draw[color=gray,thin] (10,0) -- +(0,15.5);
		\draw[color=gray,thin] (20,0) -- +(0,14.5);
		\draw[color=gray,thin] (30,0) -- +(0,13.5);
		\draw[color=gray,thin] (40,0) -- +(0,12);
		\draw[color=gray,thin] (50,0) -- +(0,10);
		\draw[color=gray,thin] (60,0) -- +(0,7);
		\draw[color=gray,thin] (70,0) -- +(0,3.8);
		
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataOPTIfiveH};
	\addplot[blue, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIfiveHfine};
	\end{axis}
	
	\begin{axis}[
	clip mode=individual,
	ymin=0, ymax=0.2,
	axis y line*=right,
	xtick=\empty,
	xlabel=\empty,
	%xlabel near ticks,\dataOPTIoneK
	ylabel={$\alpha$ (rad)},
	ylabel near ticks,
	]
	% aircraft controls
	\addplot[red, line width=0.5pt, mark=none,forget plot] table[x index=0, y index=2]{\dataOPTIfiveH};
	\addplot[blue, line width=0.5pt, mark=none,forget plot] table[x index=0, y 
	index=4]{\dataVIfiveHfine};
	
	\addlegendimage{red,line width=1.2pt, mark=none}\addlegendentry{OC}
	\addlegendimage{red,line width=0.5pt, mark=none}\addlegendentry{OC - control sequence}
	\addlegendimage{blue,line width=1.2pt, mark=none}\addlegendentry{VI}
	\addlegendimage{blue,line width=0.5pt, mark=none}\addlegendentry{VI - control sequence}
	
	\end{axis}
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (0,0.409*\textheight) {\includegraphics[ width=1.5cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\end{tikzpicture}
	\caption{Results of value iteration and optimal control in scenario 1 with a fine grid}
	\label{tikz:vi500m}
\end{figure}

Figure \ref{tikz:vi500m} shows in blue the trajectory after only 7 value iterations. To smoothen the control sequence and trajectory, the results of VI have been used to train a neural network. The actions during the simulation are ANN outputs. As can be seen, both the policy from VI and the optimal control direct the agent towards the target. The differences between the control sequences are only minor, which leads to a difference in flight times of only 0.3 s. Although the trajectories differ more, the result is satisfactory.

\begin{table}[htb]
	\begin{center}
		\begin{tabular}{l|c c}
			algorithm & OC & VI \\ \hline 
			iterations (-) & - & 8 \\
			calculation time (h:min) & 1:31 & 5:00 \\
			flight time (s) & 47.0 & 49.8
		\end{tabular}
		\caption{Flight- and computation-times for OC and asynchronous VI in scenario 2}
		\label{tab:2d_flight_data_1000m}
	\end{center}
\end{table}
\FloatBarrier

\subsubsection{Scenario 2}

In scenario 2, the agent has to cover a distance of 1000m, the start state and wind conditions are the same as in scenario 1. Fig.~\ref{tikz:vi1000m} shows the trajectory after 8 value iterations. The flight and calculation times can be found in table~\ref{tab:2d_flight_data_1000m}.

\tikzsetnextfilename{optiandvi1000m}
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.85\textwidth,
		height=0.65\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=1000,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	
			\draw[color=gray,thin] (0,2) -- +(72,0);
	\draw[color=gray,thin] (0,4) -- +(69,0);
	\draw[color=gray,thin] (0,6) -- +(65,0);
	\draw[color=gray,thin] (0,8) -- +(58,0);
	\draw[color=gray,thin] (0,10) -- +(50,0);
	\draw[color=gray,thin] (0,12) -- +(40,0);
	\draw[color=gray,thin] (0,14) -- +(25,0);
	\draw[color=gray,thin] (0,16) -- +(5,0);
	
	\draw[color=gray,thin] (10,0) -- +(0,15.5);
	\draw[color=gray,thin] (20,0) -- +(0,14.5);
	\draw[color=gray,thin] (30,0) -- +(0,13.5);
	\draw[color=gray,thin] (40,0) -- +(0,12);
	\draw[color=gray,thin] (50,0) -- +(0,10);
	\draw[color=gray,thin] (60,0) -- +(0,7);
	\draw[color=gray,thin] (70,0) -- +(0,3.8);
	% aircraft trajectory
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataOPTIoneK};
	\addplot[blue, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneK};
	\end{axis}
	
	\begin{axis}[
	clip mode=individual,
	ymin=0, ymax=0.2,
	axis y line*=right,
	xtick=\empty,
	xlabel=\empty,
	%xlabel near ticks,
	ylabel={$\alpha$ (rad)},
	ylabel near ticks,
	]
	% aircraft controls
	\addplot[red, line width=0.5pt, mark=none,forget plot] table[x index=0, y index=2]{\dataOPTIoneK};
	\addplot[blue, line width=0.5pt, mark=none,forget plot] table[x index=0, y 
	index=4]{\dataVIoneK};
	
	\addlegendimage{red,line width=1.2pt, mark=none}\addlegendentry{OC}
	\addlegendimage{red,line width=0.5pt, mark=none}\addlegendentry{OC - control sequence}
	\addlegendimage{blue,line width=1.2pt, mark=none}\addlegendentry{VI}
	\addlegendimage{blue,line width=0.5pt, mark=none}\addlegendentry{VI - control sequence}
	
	\end{axis}
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (0,0.409*\textheight) {\includegraphics[ width=1.5cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\end{tikzpicture}	
	\caption{Results of value iteration and optimal control in scenario 2}
	\label{tikz:vi1000m}
\end{figure}
\FloatBarrier
%\subsubsection{Scenario 3}
%
%In scenario 3, the agent has to cover a distance of 2000m, the start state and wind conditions are the same as in scenario 1. Fig.~\ref{tikz:vi2000m} shows the trajectory after  value iterations. The flight and calculation times can be found in table~\ref{tab:2d_flight_data_2000m}.
%
%\begin{table}[htb]
%	\begin{center}
%		\begin{tabular}{l|c c}
%			algorithm & OC & VI \\ \hline 
%			iterations (-) & - &  \\
%			calculation time (h:min) &&  \\
%			flight time (s) &  & 
%		\end{tabular}
%		\caption{Flight- and computation-times for OC, OPI and VI in scenario 3}
%		\label{tab:2d_flight_data_2000m}
%	\end{center}
%\end{table}
%
%\tikzsetnextfilename{optiandvi2000m}
%\begin{figure}[htb]
%	\centering
%	\begin{tikzpicture}
%	
%	\pgfplotsset{
%		width=0.85\textwidth,
%		height=0.65\textwidth, 
%		xmajorgrids, 
%		ymajorgrids, 
%		enlarge x limits=false,
%		scaled x ticks = false,
%		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
%		scaled y ticks = false,
%		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
%		xmin=0, xmax=2000,
%		legend pos=north east,
%		legend cell align=left
%	}
%	
%	\begin{axis}[
%	% hide x-axis once
%	% grid andeuten (andere Farbe)
%	clip mode=individual,
%	ymin=0, ymax=100,
%	axis y line*=left,
%	xlabel={distance (m)},
%	xlabel near ticks,
%	ylabel={height $-z$ (m)},
%	ylabel near ticks,
%	]	
%	% aircraft trajectory
%	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataOPTItwoK};
%	\addplot[blue, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVItwoK};
%	\end{axis}
%	
%	\begin{axis}[
%	clip mode=individual,
%	ymin=0, ymax=0.2,
%	axis y line*=right,
%	xtick=\empty,
%	xlabel=\empty,
%	%xlabel near ticks,
%	ylabel={$\alpha$ (rad)},
%	ylabel near ticks,
%	]
%	% aircraft controls
%	\addplot[red, line width=0.5pt, mark=none,forget plot] table[x index=0, y index=2]{\dataOPTItwoK};
%	\addplot[blue, line width=0.5pt, mark=none,forget plot] table[x index=0, y 
%	index=4]{\dataVItwoK};
%	
%	\addlegendimage{red,line width=1.2pt, mark=none}\addlegendentry{OC}
%	\addlegendimage{red,line width=0.5pt, mark=none}\addlegendentry{OC - control sequence}
%	\addlegendimage{blue,line width=1.2pt, mark=none}\addlegendentry{VI}
%	\addlegendimage{blue,line width=0.5pt, mark=none}\addlegendentry{VI - control sequence}
%	
%	\end{axis}
%	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (0,0.409*\textheight) {\includegraphics[ width=1.5cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
%	\end{tikzpicture}	
%	\caption{Results of value iteration and optimal control in scenario 2}
%	\label{tikz:vi1000m}
%\end{figure}

\newpage
\subsection{Policy Initialization for TRPO}
\label{sec:dp_init_trpo}
In the previous section, it was shown that value iteration is a viable alternative for optimal control in certain path planning scenarios. The goal of this section is to find out whether value iteration can also serve to accelerate convergence of a TRPO algorithm.

The parameters of a neural network are usually initialized randomly according to a specific probability distribution (cf. section~\ref{sec:weight_init}). The idea behind policy initialization by DP is to use a set of weights, that have already been optimized in a similar scenario, in order to speed up convergence of a subsequent training procedure.

The TRPO training procedure differs from the one in dynamic programming. Instead of sweeping over the complete state space and performing a one step lookahead at each point, TRPO samples complete trajectories.

The performance of TRPO can either be measured by flight times (like in section \ref{sec:results_dp}) or by the return per iteration. Figures~\ref{tikz:trpoglorotvi1000mAvg} and \ref{tikz:trpoglorotvi1000mMax} show the average and maximal return per iteration of TRPO, respectively. In this TRPO algorithm, an iteration consists of 25 episodes, i.e. 25 flights through the state space. After each iteration, the policy parameters are changed in order to increase the expected return. More information about TRPO can be found in \cite{DBLP:journals/corr/SchulmanLMJA15}. A detailed description of glider trajectory optimization through TRPO is contained in \cite{Zuern2017}.

The benchmark for DP pre-training is scenario 2. The agent has to cover 1000m through calm air and starts at a height of 100m with zero velocity.

The plots of the average and maximum return per iteration typically have an exponential shape. The average return has numerous downward peaks, which is due to the exploration aspect of TRPO. This is the desired behavior and is not affected by pre-training, as Fig.~\ref{tikz:trpoglorotvi1000mAvg} shows. The pre-trained policy performs better at early iterations, but the effect fades away after about 270 iterations.

\tikzsetnextfilename{trpoglorotvsvi1000mAvg}
\begin{figure}[hbt]
	\centering
%	\begin{tikzpicture}
%	
%	\pgfplotsset{
%		width=0.5\textwidth,
%		height=0.25\textwidth, 
%		xmajorgrids, 
%		ymajorgrids, 
%		enlarge x limits=false,
%		scaled x ticks = false,
%		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
%		scaled y ticks = false,
%		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
%		xmin=0, xmax=300,
%		legend pos=south east,
%		legend cell align=left
%	}
%	
%	\begin{axis}[
%	% hide x-axis once
%	% grid andeuten (andere Farbe)
%	clip mode=individual,
%	ymin=20, ymax=60,
%	axis y line*=left,
%	xlabel={iteration},
%	xlabel near ticks,
%	ylabel={Average Return},
%	ylabel near ticks,
%	]	
%	% aircraft trajectory
%	\addplot[red, line width=0.5pt, mark=none,forget plot] table[x index=0, y index=1]{\trpoGlorotVsVIoneKAvgReturn};
%	\addplot[blue, line width=0.5pt, mark=none,forget plot] table[x index=0, y 
%	index=2]{\trpoGlorotVsVIoneKAvgReturn};
%
%	\end{axis}
%		
%	\end{tikzpicture}
	
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.85\textwidth,
		height=0.4\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=800,
		legend pos=south east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=60,
	axis y line*=left,
	xlabel={iteration},
	xlabel near ticks,
	ylabel={Average Return},
	ylabel near ticks,
	]	
	% aircraft trajectory
	\addplot[red, line width=0.5pt, mark=none,forget plot] table[x index=0, y index=1]{\trpoGlorotVsVIoneKAvgReturn};
	\addplot[blue, line width=0.5pt, mark=none,forget plot] table[x index=0, y 
	index=2]{\trpoGlorotVsVIoneKAvgReturn};
	
	\addlegendimage{red,line width=0.8pt, mark=none}\addlegendentry{glorot uniform initialization}
	\addlegendimage{blue,line width=0.8pt, mark=none}\addlegendentry{value iteration}
	
	\end{axis}

	\end{tikzpicture}
	\caption{Average return per iteration with and without policy initialization}
	\label{tikz:trpoglorotvi1000mAvg}
\end{figure}

\tikzsetnextfilename{trpoglorotvsvi1000mMax}
\begin{figure}[hbt]
	\centering
%	\begin{tikzpicture}
%	
%	\pgfplotsset{
%		width=0.5\textwidth,
%		height=0.25\textwidth, 
%		xmajorgrids, 
%		ymajorgrids, 
%		enlarge x limits=false,
%		scaled x ticks = false,
%		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
%		scaled y ticks = false,
%		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
%		xmin=0, xmax=300,
%		legend pos=south east,
%		legend cell align=left
%	}
%	
%	\begin{axis}[
%	% hide x-axis once
%	% grid andeuten (andere Farbe)
%	clip mode=individual,
%	ymin=20, ymax=60,
%	axis y line*=left,
%	xlabel={iteration},
%	xlabel near ticks,
%	ylabel={Average Return},
%	ylabel near ticks,
%	]	
%	% aircraft trajectory
%	\addplot[red, line width=0.5pt, mark=none,forget plot] table[x index=0, y index=1]{\trpoGlorotVsVIoneKMaxReturn};
%	\addplot[blue, line width=0.5pt, mark=none,forget plot] table[x index=0, y 
%	index=2]{\trpoGlorotVsVIoneKMaxReturn};
%	
%	\end{axis}
%	
%	\end{tikzpicture}
	
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.85\textwidth,
		height=0.4\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=800,
		legend pos=south east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=60,
	axis y line*=left,
	xlabel={iteration},
	xlabel near ticks,
	ylabel={Average Return},
	ylabel near ticks,
	]	
	% aircraft trajectory
	\addplot[red, line width=0.5pt, mark=none,forget plot] table[x index=0, y index=1]{\trpoGlorotVsVIoneKMaxReturn};
	\addplot[blue, line width=0.5pt, mark=none,forget plot] table[x index=0, y 
	index=2]{\trpoGlorotVsVIoneKMaxReturn};
	
	\addlegendimage{red,line width=0.8pt, mark=none}\addlegendentry{glorot uniform initialization}
	\addlegendimage{blue,line width=0.8pt, mark=none}\addlegendentry{value iteration}
	
	\end{axis}
	
	\end{tikzpicture}	
	\caption{Maximum return per iteration with and without policy initialization}
	\label{tikz:trpoglorotvi1000mMax}
\end{figure}
\newpage
\FloatBarrier

To see if TRPO spoils the policy's ability to find the goal from initial states that differ from table \ref{tab:scenario_data}, the agent is launched from other states than before. Three policies are compared:

\begin{itemize}
	\item $\pi_1$: A policy obtained by VI
	\item $\pi_2$: A policy obtained by TRPO\footnote{The start state for TRPO is $s_{0,\text{TRPO}}=(0,100,0,0)^\top$.}
	\item $\pi_3$: A policy initialized by VI and optimized by TRPO
\end{itemize}

Table \ref{tab:vi_trpo_flighttimes} contains the flight times obtained with the three policies from varying initial states. In the first three rows, the agent's initial state is $s_0=(x_0,100 \text{m},0 \frac{m}{s},0\frac{m}{s})^\top$. Rows four to six contain flight times of flights starting at $s_0=(x_0,80\text{m},-20 \frac{m}{s},0\frac{m}{s})^\top$. Red table cells mark flights that ended on the ground and did not reach a goal state. Green table cells mark the shortest flight time from the given initial state, i.e. the policy that did best in that case.
\setlength{\belowcaptionskip}{-20pt}
\begin{table}[htb]
	\begin{center}
		\begin{tabular}{|c|c|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|}
			\hline
			&\backslashbox{$u_0$ ($\frac{m}{s}$)}{$x_0$ (m)}& 0 &100&200&300&400&500&600&700&800&900&999 \\ \hline 
			$\pi_1$ & $0$&49.8&44.0&38.2&33.0&\cellcolor{green!20}27.7&\cellcolor{green!20}23.0&\cellcolor{green!20}18.5&\cellcolor{green!20}14.0&10.0&6.2&- \\
			$\pi_2$ & $0$&47.5&43.7&35.9&31.3&\cellcolor{red!20}8.6&\cellcolor{red!20}14.5&\cellcolor{red!20}8&\cellcolor{red!20}7.8&\cellcolor{red!20}7.4&\cellcolor{green!20}6.1&- \\
			$\pi_3$ & $0$&\cellcolor{green!20}47.3&\cellcolor{green!20}40.9&\cellcolor{green!20}34.9&\cellcolor{green!20}29.3&\cellcolor{red!20}18.2&\cellcolor{red!20}14.2&\cellcolor{red!20}12.3&\cellcolor{red!20}11.2&\cellcolor{green!20}9.4&6.2&- \\ \hline
			$\pi_1$& $-20$ & - &44.7&38.7&33.2&27.7&22.7&\cellcolor{green!20}18.0&\cellcolor{green!20}13.5&\cellcolor{green!20}9.2&5.2&1.7 \\ 
			
			$\pi_2$& $-20$ & - & 41.8 & \cellcolor{green!20}35.3 & 31.3&\cellcolor{red!20}16.4&\cellcolor{red!20}6.1&\cellcolor{red!20}6.0 &\cellcolor{red!20}5.6&\cellcolor{red!20}5.4&\cellcolor{green!20}4.9&\cellcolor{green!20}1.4 \\
			
			$\pi_3$& $-20$ &-&\cellcolor{green!20}41.6&\cellcolor{green!20}35.3&\cellcolor{green!20}29.4 &\cellcolor{green!20}23.9& \cellcolor{green!20}18.9&\cellcolor{red!20}10.2&\cellcolor{red!20}8.8&\cellcolor{red!20}7.9&5.3&1.8 \\ \hline
		\end{tabular}
		\caption{Flight times of agents with three different policy initialization techniques and different start states}
		\label{tab:vi_trpo_flighttimes}
	\end{center}
\end{table}

The first policy $\pi_1$ is the same that yielded the results in Fig. \ref{tikz:vi1000m}. Figures \ref{tikz:vi_result_before_trpo} and \ref{tikz:vi_result_before_trpo_2} show how the agent with $\pi_1$ behaves when confronted with varying initial states. He is able to reach the goal from all tested initial states.

The trajectories obtained by $\pi_2$ can be seen in Fig. \ref{tikz:trpo_result} and \ref{tikz:trpo_result_2}. The agent manages to reach the goal only from states that lie close to $s_{0,\text{TRPO}}$ or very close to the goal. This is not surprising, since TRPO only optimizes one trajectory, namely the one from $s_{0,\text{TRPO}}$ to the goal. Trajectories, that lead to the goal, take less time than those obtained with $\pi_1$ (cf. table \ref{tab:vi_trpo_flighttimes}). Trajectories, that do not start in $s_{0,\text{TRPO}}$, seem to try to follow the optimal trajectory from $s_{0,\text{TRPO}}$, but, depending on the specific initial state, make a more or less significant "detour" and are not as smooth as the VI results in Fig.~\ref{tikz:vi_result_before_trpo} and~\ref{tikz:vi_result_before_trpo_2}. However, the trajectories, that reach the goal, perform better than those obtained with $\pi_1$.

In Fig. \ref{tikz:vi_result_after_trpo}, the agent faces the same start states as in Fig. \ref{tikz:vi_result_before_trpo}. The trajectory starting at $x=0m$ is almost identical to the optimal control result in Fig.~\ref{tikz:vi1000m}). This is the expected result, because $s_0 = (0,100,0,0)^\top$ is also the initial state of the TRPO calculation, which, according to \cite{Zuern2017}, obtains nearly optimal trajectories from a predefined start state in the given scenario. All trajectories, that start at different states, try to reach the optimal trajectory from $s_0$ and follow it to the goal. Those, that start close to $s_0$, intercept the optimal trajectory at a moderate angle and succeed in reaching the goal. The trajectories starting between $x=400m$ and $x=800m$ do not end in a goal state, but on the ground. They pass through the optimal trajectory from above and touch the ground between $x=750m$ and $x=920m$. The respective flight times are marked red in table \ref{tab:vi_trpo_flighttimes}.

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x0z100u0w0.dat}}\dataVIoneKxzero
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x100z100u0w0.dat}}\dataVIoneKxoneh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x200z100u0w0.dat}}\dataVIoneKxtwoh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x300z100u0w0.dat}}\dataVIoneKxthreeh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x400z100u0w0.dat}}\dataVIoneKxfourh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x500z100u0w0.dat}}\dataVIoneKxfiveh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x600z100u0w0.dat}}\dataVIoneKxsixh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x700z100u0w0.dat}}\dataVIoneKxsevenh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x800z100u0w0.dat}}\dataVIoneKxeighth
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x900z100u0w0.dat}}\dataVIoneKxnineh

\tikzsetnextfilename{vi_result_before_trpo}
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.9\textwidth,
		height=0.4\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=1000,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	
	
	% aircraft trajectory
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxzero};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxoneh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxtwoh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxthreeh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxfourh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxfiveh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxsixh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxsevenh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxeighth};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxnineh};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (0,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (100,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (200,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (300,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (400,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (500,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (600,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (700,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (800,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (900,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};														
	\end{axis}
	
	%	\begin{axis}[
	%	clip mode=individual,
	%	ymin=0, ymax=0.2,
	%	axis y line*=right,
	%	xtick=\empty,
	%	xlabel=\empty,
	%	%xlabel near ticks,
	%	ylabel={$\alpha$ (rad)},
	%	ylabel near ticks,
	%	]
	%		
	%	\end{axis}
	
	\end{tikzpicture}	
	\caption{VI - trajectories from various initial states with zero velocity}
	\label{tikz:vi_result_before_trpo}
\end{figure}

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x100z80u-20w0.dat}}\dataVIoneKxonehb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x200z80u-20w0.dat}}\dataVIoneKxtwohb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x300z80u-20w0.dat}}\dataVIoneKxthreehb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x400z80u-20w0.dat}}\dataVIoneKxfourhb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x500z80u-20w0.dat}}\dataVIoneKxfivehb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x600z80u-20w0.dat}}\dataVIoneKxsixhb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x700z80u-20w0.dat}}\dataVIoneKxsevenhb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x800z80u-20w0.dat}}\dataVIoneKxeighthb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x900z80u-20w0.dat}}\dataVIoneKxninehb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x999z80u-20w0.dat}}\dataVIoneKxoneKb

\tikzsetnextfilename{vi_result_before_trpo2}
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.9\textwidth,
		height=0.4\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=1000,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	
	
	% aircraft trajectory
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxonehb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxtwohb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxthreehb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxfourhb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxfivehb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxsixhb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxsevenhb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxeighthb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxninehb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxoneKb};
	
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (100,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (200,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (300,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (400,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (500,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (600,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (700,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (800,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (900,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (999,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	
	\end{axis}
	
	%	\begin{axis}[
	%	clip mode=individual,
	%	ymin=0, ymax=0.2,
	%	axis y line*=right,
	%	xtick=\empty,
	%	xlabel=\empty,
	%	%xlabel near ticks,
	%	ylabel={$\alpha$ (rad)},
	%	ylabel near ticks,
	%	]
	%		
	%	\end{axis}
	
	\end{tikzpicture}	
	\caption{VI - trajectories from various initial states with ${}_g u_K = -20 \frac{m}{s}$}
	\label{tikz:vi_result_before_trpo_2}
\end{figure}

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x0z100u0w0_after_trpo.dat}}\dataTRPOoneKxzero
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x100z100u0w0_after_trpo.dat}}\dataTRPOoneKxoneh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x200z100u0w0_after_trpo.dat}}\dataTRPOoneKxtwoh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x300z100u0w0_after_trpo.dat}}\dataTRPOoneKxthreeh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x400z100u0w0_after_trpo.dat}}\dataTRPOoneKxfourh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x500z100u0w0_after_trpo.dat}}\dataTRPOoneKxfiveh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x600z100u0w0_after_trpo.dat}}\dataTRPOoneKxsixh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x700z100u0w0_after_trpo.dat}}\dataTRPOoneKxsevenh
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x800z100u0w0_after_trpo.dat}}\dataTRPOoneKxeighth
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no130_s0=x900z100u0w0_after_trpo.dat}}\dataTRPOoneKxnineh

\tikzsetnextfilename{trpo_result}
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.9\textwidth,
		height=0.4\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=1000,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	
	
	% aircraft trajectory
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxzero};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxoneh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxtwoh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxthreeh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxfourh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxfiveh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxsixh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxsevenh};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxeighth};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxnineh};
	
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (0,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (100,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (200,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (300,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (400,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (500,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (600,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (700,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (800,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (900,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};														
	\end{axis}
	
	%	\begin{axis}[
	%	clip mode=individual,
	%	ymin=0, ymax=0.2,
	%	axis y line*=right,
	%	xtick=\empty,
	%	xlabel=\empty,
	%	%xlabel near ticks,
	%	ylabel={$\alpha$ (rad)},
	%	ylabel near ticks,
	%	]
	%		
	%	\end{axis}
	
	\end{tikzpicture}	
	\caption{TRPO - trajectories from various initial states with zero velocity}
	\label{tikz:trpo_result}
\end{figure}

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x100z80u-20w0_after_trpo.dat}}\dataTRPOoneKxonehb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x200z80u-20w0_after_trpo.dat}}\dataTRPOoneKxtwohb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x300z80u-20w0_after_trpo.dat}}\dataTRPOoneKxthreehb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x400z80u-20w0_after_trpo.dat}}\dataTRPOoneKxfourhb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x500z80u-20w0_after_trpo.dat}}\dataTRPOoneKxfivehb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x600z80u-20w0_after_trpo.dat}}\dataTRPOoneKxsixhb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x700z80u-20w0_after_trpo.dat}}\dataTRPOoneKxsevenhb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x800z80u-20w0_after_trpo.dat}}\dataTRPOoneKxeighthb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x900z80u-20w0_after_trpo.dat}}\dataTRPOoneKxninehb
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no131_s0=x999z80u-20w0_after_trpo.dat}}\dataTRPOoneKxoneKb

\tikzsetnextfilename{trpo_result2}
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.9\textwidth,
		height=0.4\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=1000,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	
	
	% aircraft trajectory
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxonehb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxtwohb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxthreehb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxfourhb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxfivehb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxsixhb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxsevenhb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxeighthb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxninehb};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataTRPOoneKxoneKb};
	
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (100,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (200,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (300,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (400,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (500,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (600,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (700,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (800,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (900,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (999,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	
	\end{axis}
	
	%	\begin{axis}[
	%	clip mode=individual,
	%	ymin=0, ymax=0.2,
	%	axis y line*=right,
	%	xtick=\empty,
	%	xlabel=\empty,
	%	%xlabel near ticks,
	%	ylabel={$\alpha$ (rad)},
	%	ylabel near ticks,
	%	]
	%		
	%	\end{axis}
	
	\end{tikzpicture}	
	\caption{TRPO - trajectories from various initial states with ${}_g u_K = -20 \frac{m}{s}$}
	\label{tikz:trpo_result_2}
\end{figure}

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x0z100u0w0_after_trpo.dat}}\dataVIoneKxzerotrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x100z100u0w0_after_trpo.dat}}\dataVIoneKxonehtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x200z100u0w0_after_trpo.dat}}\dataVIoneKxtwohtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x300z100u0w0_after_trpo.dat}}\dataVIoneKxthreehtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x400z100u0w0_after_trpo.dat}}\dataVIoneKxfourhtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x500z100u0w0_after_trpo.dat}}\dataVIoneKxfivehtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x600z100u0w0_after_trpo.dat}}\dataVIoneKxsixhtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x700z100u0w0_after_trpo.dat}}\dataVIoneKxsevenhtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x800z100u0w0_after_trpo.dat}}\dataVIoneKxeighthtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x900z100u0w0_after_trpo.dat}}\dataVIoneKxninehtrpo

\tikzsetnextfilename{vi_result_after_trpo}
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.9\textwidth,
		height=0.4\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=1000,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	
	
	% aircraft trajectory
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxzerotrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxonehtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxtwohtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxthreehtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxfourhtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxfivehtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxsixhtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxsevenhtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxeighthtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxninehtrpo};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (0,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (100,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (200,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (300,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (400,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (500,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (600,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (700,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (800,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};
	\node[rotate=-90, xshift=-.2cm, yshift=.1cm, fill=none] (glider) at (900,100) {\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}};														
	\end{axis}
	
	%	\begin{axis}[
	%	clip mode=individual,
	%	ymin=0, ymax=0.2,
	%	axis y line*=right,
	%	xtick=\empty,
	%	xlabel=\empty,
	%	%xlabel near ticks,
	%	ylabel={$\alpha$ (rad)},
	%	ylabel near ticks,
	%	]
	%		
	%	\end{axis}
	
	\end{tikzpicture}	
	\caption{VI and TRPO - trajectories from various initial states with zero velocity}
	\label{tikz:vi_result_after_trpo}
\end{figure}

\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x100z80u-20w0_after_trpo.dat}}\dataVIoneKxonehbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x200z80u-20w0_after_trpo.dat}}\dataVIoneKxtwohbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x300z80u-20w0_after_trpo.dat}}\dataVIoneKxthreehbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x400z80u-20w0_after_trpo.dat}}\dataVIoneKxfourhbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x500z80u-20w0_after_trpo.dat}}\dataVIoneKxfivehbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x600z80u-20w0_after_trpo.dat}}\dataVIoneKxsixhbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x700z80u-20w0_after_trpo.dat}}\dataVIoneKxsevenhbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x800z80u-20w0_after_trpo.dat}}\dataVIoneKxeighthbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x900z80u-20w0_after_trpo.dat}}\dataVIoneKxninehbtrpo
\pgfplotstableread[col sep=comma] {\detokenize{./src/pics/tikz/no120_s0=x999z80u-20w0_after_trpo.dat}}\dataVIoneKxoneKbtrpo

\tikzsetnextfilename{vi_result_after_trpo2}
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
	
	\pgfplotsset{
		width=0.9\textwidth,
		height=0.4\textwidth, 
		xmajorgrids, 
		ymajorgrids, 
		enlarge x limits=false,
		scaled x ticks = false,
		x tick label style={/pgf/number format/.cd, fixed, set thousands separator={}},
		scaled y ticks = false,
		yticklabel style={/pgf/number format/.cd, fixed, set thousands separator={}},
		xmin=0, xmax=1000,
		legend pos=north east,
		legend cell align=left
	}
	
	\begin{axis}[
	% hide x-axis once
	% grid andeuten (andere Farbe)
	clip mode=individual,
	ymin=0, ymax=100,
	axis y line*=left,
	xlabel={distance (m)},
	xlabel near ticks,
	ylabel={height $-z$ (m)},
	ylabel near ticks,
	]	
	
	% aircraft trajectory
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxonehbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxtwohbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxthreehbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxfourhbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxfivehbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxsixhbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxsevenhbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxeighthbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxninehbtrpo};
	\addplot[red, line width=1.2pt, mark=none,forget plot] table[x index=0, y index=1]{\dataVIoneKxoneKbtrpo};
	
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (100,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (200,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (300,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (400,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (500,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (600,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (700,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (800,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (900,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	\node[rotate=180, xshift=-.2cm, yshift=-.05cm, fill=none] (glider) at (999,80)  { \scalebox{1}[-1]{\includegraphics[ width=1cm, keepaspectratio]{./src/pics/tikz/simpleGlider.pdf}}};
	
	\end{axis}
	
	%	\begin{axis}[
	%	clip mode=individual,
	%	ymin=0, ymax=0.2,
	%	axis y line*=right,
	%	xtick=\empty,
	%	xlabel=\empty,
	%	%xlabel near ticks,
	%	ylabel={$\alpha$ (rad)},
	%	ylabel near ticks,
	%	]
	%		
	%	\end{axis}
	
	\end{tikzpicture}	
	\caption{VI and TRPO - trajectories from various initial states with ${}_g u_K = -20 \frac{m}{s}$}
	\label{tikz:vi_result_after_trpo_2}
\end{figure}

%\begin{table}[htb]
%	\begin{center}
%		\begin{tabular}{|c|c|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|C{0.6cm}|}
%			\hline
%			&\backslashbox{$u_0$ ($\frac{m}{s}$)}{$x_0$ (m)}& 0 &100&200&300&400&500&600&700&800&900&999 \\ \hline 
%			$\pi_1$ & $0$&49.8&44.0&38.2&33.0&\cellcolor{green!20}27.7&\cellcolor{green!20}23.0&\cellcolor{green!20}18.5&\cellcolor{green!20}14.0&10.0&6.2&- \\
%			& $-20$ & - &44.7&38.7&33.2&27.7&22.7&\cellcolor{green!20}18.0&\cellcolor{green!20}13.5&\cellcolor{green!20}9.2&5.2&1.7 \\ \hline
%			$\pi_2$ & $0$&47.5&43.7&35.9&31.3&\cellcolor{red!20}8.6&\cellcolor{red!20}14.5&\cellcolor{red!20}8&\cellcolor{red!20}7.8&\cellcolor{red!20}7.4&\cellcolor{green!20}6.1&- \\
%			& $-20$ &-&41.8&\cellcolor{green!20}35.3&31.3&\cellcolor{red!20}16.4&\cellcolor{red!20}6.1&\cellcolor{red!20}6.0&\cellcolor{red!20}5.6&\cellcolor{red!20}5.4&\cellcolor{green!20}4.9&\cellcolor{green!20}1.4 \\ \hline
%			$\pi_3$ & $0$&\cellcolor{green!20}47.3&\cellcolor{green!20}40.9&\cellcolor{green!20}34.9&\cellcolor{green!20}29.3&\cellcolor{red!20}18.2&\cellcolor{red!20}14.2&\cellcolor{red!20}12.3&\cellcolor{red!20}11.2&\cellcolor{green!20}9.4&6.2&- \\
%			& $-20$ &-&\cellcolor{green!20}41.6&\cellcolor{green!20}35.3&\cellcolor{green!20}29.4&\cellcolor{green!20}23.9&\cellcolor{green!20}18.9&\cellcolor{red!20}10.2&\cellcolor{red!20}8.8&\cellcolor{red!20}7.9&5.3&1.8 \\ \hline
%		\end{tabular}
%		\caption{Flight times of agents with a different policy initialization techniques and different start states}
%		\label{tab:vi_trpo_flighttimes}
%	\end{center}
%\end{table}
